---
title: "Assignment-04"
author: "Mitch Lueken"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
```
   
## Introduction  

Based upon anecdotal evidence (personal experience), Dr. Franklund believes that there may be an association between the type of vehicle people drive with the liklihood that they will adorn that vehicle with window and/or bumper stickers. This brief project serves both to test that hypothesis and provide an opportunity to practice collecting and using "tidy" data.

100 cars were surveyed from the local area, and their make, type, and color were recorded, as well as whether they had a bumper sticker or not. Alternatively, the code in Generator.Rmd created Data.csv using simulated data.

## Procedure

```{r heyLookData, echo = FALSE, message = FALSE}
mrTibbles <- read_csv("Data.csv")

knitr::kable(mrTibbles %>% group_by(Make) %>% summarize(Number = n()) %>% arrange(desc(Number)), caption = "**Table 1:** Vehicle Make Frequency") %>% kable_styling(full_width = FALSE, position = "float_left")

knitr::kable(mrTibbles %>% group_by(Type) %>% summarize(Number = n()) %>% arrange(desc(Number)), caption = "**Table 2:** Vehicle Type Frequency") %>% kable_styling(full_width = FALSE, position = "float_left")

knitr::kable(mrTibbles %>% group_by(Color) %>% summarize(Number = n()) %>% arrange(desc(Number)), caption = "**Table 3:** Vehicle Color Frequency")  %>% kable_styling(full_width = FALSE, position = "left")
```

<br/>
<br/>
<br/>
<br/>
words
<br/>

---

## Results

### Window/bumper sticker frequency compared to vehicle type

```{r type, echo = FALSE, message = FALSE, error = FALSE, fig.cap = "**Figure 1:** Sticker Frequency by Vehicle Type"}
mrTibbles %>%
	select(Type, Sticker) %>%
	group_by(Type) %>%
	add_tally() %>%
	filter(Sticker) %>%
	add_tally(wt = Sticker) %>%
	distinct() %>%
	transmute(Type, SuperFreq = nn / n) %>%
	ggplot() + geom_bar(aes(x = Type, y = SuperFreq), stat = "summary", fun = "mean", fill = c("#005333","#331166","#FF0000", "#664422")) + ylim(0,1) + labs(x = "Vehicle Type", y = "Sticker Frequency")
```

Words.
  
```{r typeANOVA, echo = FALSE, message = FALSE}

mrsTibbles <- mrTibbles %>%
	select(Type, Sticker) %>%
	group_by(Type)

knitr::kable(anova(lm(Sticker ~ Type, data = mrsTibbles)),
	digits = 3, 
	format = "html", 
	caption = "*Table 4:* One-way ANOVA analysis of Sticker Frequency and Vehicle Type",
	table.attr = "style='width:70%;'") %>%
kable_styling(position = "center")
```
  
### Window/bumper sticker frequency compared to vehicle make

```{r make, echo = FALSE, message = FALSE, fig.cap = "**Figure 2:** Sticker Frequency by Vehicle Make"}
mrTibbles %>%
	select(Make, Sticker) %>%
	group_by(Make) %>%
	add_tally() %>%
	filter(Sticker) %>%
	add_tally(wt = Sticker) %>%
	distinct() %>%
	transmute(Make, SuperFreq = nn / n) %>%
	ggplot() + geom_bar(aes(x = Make, y = SuperFreq), stat = "summary", fun = "mean", fill = c("#002244","#224400","#442200", "#664422", "#446622", "#226644", "#006622")) + ylim(0,1) + labs(x = "Vehicle Make", y = "Sticker Frequency")
```

Words
  
```{r makeANOVA, echo = FALSE}
mrsTibbles <- mrTibbles %>%
	select(Make, Sticker) %>%
	group_by(Make)

knitr::kable(anova(lm(Sticker ~ Make, data = mrsTibbles)),
	digits = 3, 
	format = "html", 
	caption = "*Table 5:* One-way ANOVA analysis of Sticker Frequency and Vehicle Make",
	table.attr = "style='width:70%;'") %>%
kable_styling(position = "center")
```
  
### Window/bumper sticker frequency compared to vehicle color

```{r color, echo = FALSE, message = FALSE, fig.cap = "**Figure 3:** Sticker Frequency by Vehicle Color"}
mrTibbles %>%
	select(Color, Sticker) %>%
	group_by(Color) %>%
	add_tally() %>%
	filter(Sticker) %>%
	add_tally(wt = Sticker) %>%
	distinct() %>%
	transmute(Color, SuperFreq = nn / n) %>%
	ggplot() + geom_bar(aes(x = Color, y = SuperFreq), stat = "summary", fun = "mean", fill = c("#000000", "#3338FF", "#6A421A", "#229911", "#999999", "#EE1F1F", "#FFFFFF", "#FFFB1D")) + ylim(0,1) + labs(x = "Vehicle Color", y = "Sticker Frequency")
```

Words
  
```{r colorANOVA, echo = FALSE}
mrsTibbles <- mrTibbles %>%
	select(Color, Sticker) %>%
	group_by(Color)

knitr::kable(anova(lm(Sticker ~ Color, data = mrsTibbles)),
	digits = 3, 
	format = "html", 
	caption = "*Table 6:* One-way ANOVA analysis of  Sticker Frequency and Vehicle Color",
	table.attr = "style='width:70%;'") %>%
kable_styling(position = "center")
```
  
## Conclusions

More words.
