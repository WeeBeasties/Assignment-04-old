---
title: "Assignment-04"
author: "Mitch Lueken"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---

```{css width, echo = FALSE}
div.a, div.b, div.c, div.d, div.e, div.f {
	width: 683px;
}
caption {
      color: black;
}
```

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width = 683)
library(tidyverse)
library(kableExtra)
```

---

## Introduction  

<div class="a">
Based upon anecdotal evidence (personal experience), Dr. Franklund believes that there may be an association between the type of vehicle people drive with the liklihood that they will adorn that vehicle with window and/or bumper stickers. This brief project serves both to test that hypothesis and provide an opportunity to practice collecting and using "tidy" data.
</div>

---

## Procedure

<div class="b">
118 cars were surveyed at random from a Lansing-adjacent residential area on 2020-06-17 around 1300. Their make, type, and color were recorded, as well as whether they had a window/bumper sticker or not. The data was encoded into "RealData.csv".
</div>

```{r heyLookData, echo = FALSE, message = FALSE}
mrTibbles <- read_csv("RealData.csv")
```

---

## Results

```{r bobbyTables, echo = FALSE, message = FALSE}
knitr::kable(mrTibbles %>% group_by(Make) %>% summarize(Number = n()) %>% arrange(desc(Number)), caption = "**Table 1:** Vehicle Make Tally") %>% kable_styling(full_width = FALSE, position = "float_left")

knitr::kable(mrTibbles %>% group_by(Type) %>% summarize(Number = n()) %>% arrange(desc(Number)), caption = "**Table 2:** Vehicle Type Tally") %>% kable_styling(full_width = FALSE, position = "float_left")

knitr::kable(mrTibbles %>% group_by(Color) %>% summarize(Number = n()) %>% arrange(desc(Number)), caption = "**Table 3:** Vehicle Color Tally")  %>% kable_styling(full_width = FALSE, position = "left")
```

<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

### Window/bumper sticker frequency compared to vehicle type

```{r type, echo = FALSE, message = FALSE, error = FALSE, fig.cap = "**Figure 1:** Sticker Frequency by Vehicle Type", fig.align = "left", out.width = 683}
mrTibbles %>%
	select(Type, Sticker) %>%
	group_by(Type) %>%
	add_tally() %>%
	filter(Sticker) %>%
	add_tally(wt = Sticker) %>%
	distinct() %>%
	transmute(Type, SuperFreq = 100 * nn / n) %>%
	ggplot() + geom_bar(aes(x = Type, y = SuperFreq), stat = "summary", fun = "mean", fill = c("#005333","#331166","#FF0000", "#664422")) + ylim(0,100) + labs(x = "Vehicle Type", y = "Sticker Frequency (%)")
```

<br/>
<div class="c">
While the data conformed to expectations (trucks and vans over-represented among vehicles with stickers, see Figure 1), the analysis of variance (Table 4) did not find the trend to be significant. Sedans (even several Priuses/Prii) had fewer bumper stickers than other vehicle types.
</div>
<br/>

```{r typeANOVA, echo = FALSE, message = FALSE}

mrsTibbles <- mrTibbles %>%
	select(Type, Sticker) %>%
	group_by(Type)

knitr::kable(anova(lm(Sticker ~ Type, data = mrsTibbles)),
	digits = 3, 
	format = "html", 
	caption = "**Table 4:** One-way ANOVA analysis of Sticker Frequency and Vehicle Type", table.attr = "style='width:683px;'") %>%
kable_styling(position = "left")
```

### Window/bumper sticker frequency compared to vehicle make

```{r make, echo = FALSE, message = FALSE, fig.cap = "**Figure 2:** Sticker Frequency by Vehicle Make", fig.align = "left", out.width = 683}
tidying <- function(Sticker, nn) {
	count = 1
	for(entry in nn) {
		if(entry == 0) {
			Sticker[[count]] = TRUE
		}
		count = count + 1
	}
	return(Sticker)
}

mrTibbles %>%
	select(Make, Sticker) %>%
	group_by(Make) %>%
	add_tally() %>%
	add_tally(wt = Sticker) %>%
	mutate(Sticker = tidying(Sticker, nn)) %>%
	distinct() %>%
	filter(Sticker) %>%
	transmute(Make, SuperFreq = 100 * nn / n) %>%
	ggplot() + geom_bar(aes(x = Make, y = SuperFreq), stat = "summary", fun = "mean", fill = c("#A3915F","#000000","#EDD11C", "#000000", "#A1E3BF", "#123AB3", "#FF0000", "#000000", "#000000", "#1FB521", "#BDAFB4", "#000000", "#000000", "#000000", "#000000", "#951EBD", "#E3891B")) + ylim(-0,100) + labs(x = "Vehicle Make", y = "Sticker Frequency (%)")
```


<br/>
<div class="d">
Several makes of vehicles had a sticker frequency of 0% or 100% because of the small sample size (Figure 2). The only identifiable pattern is the high proportion of Dodge and GMC vehicles with stickers, which is likely accounted for by the over-representation of Dodge/GMC make trucks and vans. The analysis of variance (Table 5) found no significant results.
</div>
<br/>
  
```{r makeANOVA, echo = FALSE}
mrsTibbles <- mrTibbles %>%
	select(Make, Sticker) %>%
	group_by(Make)

knitr::kable(anova(lm(Sticker ~ Make, data = mrsTibbles)),
	digits = 3, 
	format = "html", 
	caption = "**Table 5:** One-way ANOVA analysis of Sticker Frequency and Vehicle Make",
	table.attr = "style='width:683px;'") %>%
kable_styling(position = "left")
```

### Window/bumper sticker frequency compared to vehicle color

```{r color, echo = FALSE, message = FALSE, fig.cap = "**Figure 3:** Sticker Frequency by Vehicle Color", fig.align = "left", out.width = 683}
mrTibbles %>%
	select(Color, Sticker) %>%
	group_by(Color) %>%
	add_tally() %>%
	filter(Sticker) %>%
	add_tally(wt = Sticker) %>%
	distinct() %>%
	transmute(Color, SuperFreq = 100 * nn / n) %>%
	ggplot() + geom_bar(aes(x = Color, y = SuperFreq), stat = "summary", fun = "mean", fill = c("#000000", "#2724A6", "#704D28", "#2A8014", "#999999", "#E3891B", "#FF0000", "#FFFFFF")) + ylim(0,100) + labs(x = "Vehicle Color", y = "Sticker Frequency (%)")
```


<br/>
<div class="e">
The least significant trends yet were observed with vehicle color. Except for the single orange vehicle distorting the graph (Figure 3), sticker frequency was very regularly spread among every color of vehicle. Analysis of variance (Table 6) found no significant trends.
</div>
<br/>

```{r colorANOVA, echo = FALSE}
mrsTibbles <- mrTibbles %>%
	select(Color, Sticker) %>%
	group_by(Color)

knitr::kable(anova(lm(Sticker ~ Color, data = mrsTibbles)),
	digits = 3, 
	format = "html", 
	caption = "**Table 6:** One-way ANOVA analysis of  Sticker Frequency and Vehicle Color",
	table.attr = "style='width:683px;'") %>%
kable_styling(position = "left")
```

---

## Conclusions

<div class="f">
While a potential but non-significant trend emerged relating to vehicle type, several analyses of variance found no clear correlations between vehicle type, make, or color and window/bumper sticker frequency. Larger, more physically dispersed, or more randomized sampling, or additional sampling times would change the sample. Whether this would confirm the minivan -> bumper sticker stereotype is left as an exercise to future researchers.
</div>
